GIT ?= git

TAG := v1.7.15

$(VERBOSE).SILENT:

.PHONY: @all
@all: @clean @cJSON

src:
	mkdir $@

src/cJSON.c: | src
	$(GIT) clone --depth 1 --branch $(TAG) https://github.com/DaveGamble/cJSON
	mv cJSON/.gitignore .
	mv cJSON/LICENSE .
	mv cJSON/CONTRIBUTORS.md .
	mv cJSON/cJSON.h src
	mv cJSON/cJSON.c src
	rm -rf cJSON

.PHONY: @cJSON
@cJSON: src/cJSON.c

.PHONY: @clean
@clean:
	if [ -d "src" ]; then rm -r src; fi
	if [ -f ".gitignore" ]; then rm .gitignore; fi
	if [ -f "LICENSE" ]; then rm LICENSE; fi
	if [ -f "CONTRIBUTORS.md" ]; then rm CONTRIBUTORS.md; fi
